# 모니터링 서비스 아키텍처 비교 분석

> 작성일: 2025년 12월
> 목적: LLM 모니터링 프로젝트 참고용 아키텍처 비교 분석

---

## 목차

1. [개요](#개요)
2. [메가존클라우드 (Hyper Solutions)](#1-메가존클라우드-hyper-solutions)
3. [New Relic](#2-new-relic)
4. [Prometheus + Grafana](#3-prometheus--grafana)
5. [Splunk](#4-splunk)
6. [Elastic Stack (ELK)](#5-elastic-stack-elk)
7. [OpenTelemetry](#6-opentelemetry)
8. [아키텍처 비교 요약](#7-아키텍처-비교-요약)
9. [LLM 모니터링 적용 권장사항](#8-llm-모니터링-적용-권장사항)
10. [참고 자료](#참고-자료)

---

## 개요

본 문서는 주요 모니터링/옵저버빌리티 서비스들의 아키텍처를 비교 분석합니다.

### 모니터링 서비스 분류

| 분류 | 서비스 | 특징 |
|------|--------|------|
| **SaaS (클라우드)** | Datadog, New Relic | 설치 간편, 관리 부담 없음, 구독 비용 |
| **Self-Hosted (오픈소스)** | Prometheus, ELK | 무료, 커스터마이징 자유, 운영 부담 |
| **하이브리드** | Splunk, Elastic Cloud | SaaS + On-Premise 모두 지원 |
| **MSP 서비스** | 메가존클라우드 | 클라우드 운영 대행 + 모니터링 |
| **표준 프레임워크** | OpenTelemetry | 벤더 중립, 데이터 수집 표준화 |

---

## 1. 메가존클라우드 (Hyper Solutions)

### 1.1 개요

메가존클라우드는 국내 최대 클라우드 MSP(Managed Service Provider)로, **자체 모니터링 플랫폼이 아닌 AWS 기반 관리 서비스**를 제공합니다.

| 항목 | 내용 |
|------|------|
| **회사** | 메가존클라우드 (2018년 메가존에서 분사) |
| **모델** | MSP (Managed Service Provider) |
| **핵심 역량** | AWS Premier Partner, 국내 MSP 매출 1위 (2023) |
| **모니터링 방식** | AWS CloudWatch API 기반 |

### 1.2 Hyper Solutions 구성

AWS 운영 노하우 기반의 자체 개발 솔루션 묶음입니다:

| 솔루션 | 기능 | 설명 |
|--------|------|------|
| **Hyper Watch** | 시스템 모니터링 | 리전/인스턴스 단위 CloudWatch 메트릭 시각화 |
| **Hyper Billing** | 비용 관리 | 원화 세금계산서, 태그 기준 비용 관리 |
| **Hyper Ops** | 최적화 분석 | CPU/메모리/네트워크 분석 → 인스턴스 추천 |
| **Hyper Checker** | 네트워크 점검 | 리전 간 지연시간/응답 속도 확인 |
| **Hyper Control** | 백업 관리 | 인스턴스 백업 자동화, 템플릿 재사용 |

### 1.3 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                      고객 AWS 환경                               │
│                                                                 │
│   ┌──────────┐   ┌──────────┐   ┌──────────┐   ┌──────────┐   │
│   │   EC2    │   │   RDS    │   │    S3    │   │CloudFront│   │
│   └────┬─────┘   └────┬─────┘   └────┬─────┘   └────┬─────┘   │
│        │              │              │              │          │
│        └──────────────┴──────────────┴──────────────┘          │
│                              │                                  │
│                     ┌────────▼────────┐                        │
│                     │  AWS CloudWatch │                        │
│                     │   (메트릭 수집)  │                        │
│                     └────────┬────────┘                        │
└──────────────────────────────┼──────────────────────────────────┘
                               │ CloudWatch API
                               ▼
┌─────────────────────────────────────────────────────────────────┐
│                   메가존 Hyper Solutions                         │
│                                                                 │
│   ┌─────────────┐   ┌─────────────┐   ┌─────────────┐          │
│   │ Hyper Watch │   │  Hyper Ops  │   │Hyper Billing│          │
│   │             │   │             │   │             │          │
│   │ • 멀티그래프 │   │ • 사용량분석 │   │ • 비용분석  │          │
│   │ • 리전별 뷰  │   │ • 최적화제안 │   │ • 원화청구  │          │
│   └─────────────┘   └─────────────┘   └─────────────┘          │
│                                                                 │
│   ┌──────────────────────────────────────────────────────────┐ │
│   │                    24/365 기술지원                        │ │
│   │         모니터링 → 장애감지 → 알림 → 장애대응              │ │
│   └──────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

### 1.4 특징

**장점:**
- AWS 전문 기술 지원 (24/365)
- 별도 Agent 설치 불필요 (CloudWatch API 활용)
- 비용 최적화 컨설팅 포함

**단점:**
- AWS 종속 (멀티 클라우드 지원 제한)
- 자체 데이터 저장소 없음
- 커스터마이징 제한적

---

## 2. New Relic

### 2.1 개요

New Relic은 Full-stack 옵저버빌리티 SaaS 플랫폼으로, **MELT(Metrics, Events, Logs, Traces)** 통합 데이터 모델을 사용합니다.

| 항목 | 내용 |
|------|------|
| **모델** | SaaS (클라우드) |
| **데이터 모델** | MELT (Metrics, Events, Logs, Traces) |
| **쿼리 언어** | NRQL (New Relic Query Language) |
| **수상** | Gartner Magic Quadrant 리더 (13년 연속, 2025) |

### 2.2 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                         고객 인프라                              │
│                                                                 │
│   ┌────────────────────────────────────────────────────────┐   │
│   │                  New Relic Agents                       │   │
│   │                                                         │   │
│   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │   │
│   │  │  APM Agent  │  │Infrastructure│  │Browser Agent│     │   │
│   │  │             │  │   Agent     │  │   (JS)      │     │   │
│   │  │ • Java      │  │             │  │             │     │   │
│   │  │ • Python    │  │ • 시스템메트릭│  │ • 페이지로드 │     │   │
│   │  │ • Node.js   │  │ • 프로세스   │  │ • Ajax 호출 │     │   │
│   │  │ • Ruby 등   │  │ • 컨테이너   │  │ • JS 에러   │     │   │
│   │  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘     │   │
│   │         │                │                │             │   │
│   └─────────┼────────────────┼────────────────┼─────────────┘   │
│             │                │                │                 │
└─────────────┼────────────────┼────────────────┼─────────────────┘
              │                │                │
              └────────────────┼────────────────┘
                               │ HTTPS (Push)
                               ▼
┌─────────────────────────────────────────────────────────────────┐
│                      New Relic Cloud                             │
│                                                                 │
│   ┌──────────────────────────────────────────────────────────┐ │
│   │                        NRDB                               │ │
│   │            (New Relic Database - 자체 TSDB)               │ │
│   │                                                          │ │
│   │   ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐   │ │
│   │   │ Metrics  │ │  Events  │ │   Logs   │ │  Traces  │   │ │
│   │   └──────────┘ └──────────┘ └──────────┘ └──────────┘   │ │
│   └──────────────────────────────────────────────────────────┘ │
│                               │                                 │
│                               ▼                                 │
│   ┌──────────────────────────────────────────────────────────┐ │
│   │                    Query & Analysis                       │ │
│   │                                                          │ │
│   │  • NRQL 쿼리 엔진                                         │ │
│   │  • AI/ML 기반 이상 탐지                                    │ │
│   │  • 대시보드 / 알림                                         │ │
│   └──────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

### 2.3 2025년 주요 기능

| 기능 | 설명 |
|------|------|
| **Transaction 360** | 비즈니스 트랜잭션 전체 스택 추적, 5배 빠른 문제 해결 |
| **Service Architecture Intelligence** | 서비스 카탈로그, 스코어카드, 팀/맵 관리 |
| **eAPM (eBPF 기반)** | 코드 수정 없이 자동 계측, 모든 언어 지원 |
| **Agentic AI Monitoring** | AI 에이전트 간 통신/도구 사용 추적 |
| **MCP Observability** | Model Context Protocol 서버 모니터링 (업계 최초) |

### 2.4 특징

**장점:**
- 통합 MELT 데이터 모델
- 강력한 APM (코드 레벨 추적)
- AI/ML 기반 인사이트
- LLM/AI 에이전트 모니터링 지원 (2025)

**단점:**
- 데이터가 외부 클라우드로 전송
- 대용량 데이터 시 비용 증가
- On-Premise 미지원

---

## 3. Prometheus + Grafana

### 3.1 개요

Prometheus와 Grafana는 **오픈소스 모니터링의 표준 조합**으로, CNCF(Cloud Native Computing Foundation) 졸업 프로젝트입니다.

| 항목 | Prometheus | Grafana |
|------|------------|---------|
| **역할** | 메트릭 수집/저장 | 시각화/대시보드 |
| **라이선스** | Apache 2.0 | AGPL v3 |
| **데이터 모델** | 시계열 (Time Series) | - |
| **쿼리 언어** | PromQL | - |

### 3.2 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                         고객 인프라                              │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                     모니터링 대상                           │ │
│  │                                                           │ │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  │ │
│  │  │  App 1   │  │  App 2   │  │  MySQL   │  │  Redis   │  │ │
│  │  │/metrics  │  │/metrics  │  │          │  │          │  │ │
│  │  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘  │ │
│  │       │             │             │             │         │ │
│  │       │             │        ┌────┴─────┐  ┌────┴─────┐  │ │
│  │       │             │        │  MySQL   │  │  Redis   │  │ │
│  │       │             │        │ Exporter │  │ Exporter │  │ │
│  │       │             │        └────┬─────┘  └────┬─────┘  │ │
│  └───────┼─────────────┼─────────────┼─────────────┼────────┘ │
│          │             │             │             │          │
│          └─────────────┴──────┬──────┴─────────────┘          │
│                               │                               │
│                    HTTP Pull (Scrape)                         │
│                         15초 주기                              │
│                               │                               │
│              ┌────────────────▼────────────────┐              │
│              │        Prometheus Server        │              │
│              │                                 │              │
│              │  ┌───────────────────────────┐  │              │
│              │  │    Service Discovery      │  │              │
│              │  │  • Static config          │  │              │
│              │  │  • Kubernetes SD          │  │              │
│              │  │  • Consul SD              │  │              │
│              │  └───────────────────────────┘  │              │
│              │                                 │              │
│              │  ┌───────────────────────────┐  │              │
│              │  │         TSDB              │  │              │
│              │  │   (Time Series DB)        │  │              │
│              │  │   • 로컬 디스크 저장       │  │              │
│              │  │   • 15일 기본 보관         │  │              │
│              │  └───────────────────────────┘  │              │
│              │                                 │              │
│              │  ┌───────────────────────────┐  │              │
│              │  │     Alert Rules           │  │──────┐      │
│              │  └───────────────────────────┘  │      │      │
│              └────────────────┬────────────────┘      │      │
│                               │                       │      │
│                      PromQL Query                     │      │
│                               │                       ▼      │
│              ┌────────────────▼────────────────┐  ┌───────┐  │
│              │           Grafana               │  │Alert- │  │
│              │                                 │  │manager│  │
│              │  • 대시보드 시각화               │  │       │  │
│              │  • 다중 데이터소스 지원           │  │• Slack│  │
│              │  • 알림 설정                     │  │• Email│  │
│              └─────────────────────────────────┘  │• PD   │  │
│                                                   └───────┘  │
│                                                              │
│  ┌──────────────────────────────────────────────────────────┐│
│  │              장기 저장소 (선택적)                          ││
│  │  ┌───────────┐  ┌───────────┐  ┌───────────┐            ││
│  │  │  Thanos   │  │  Cortex   │  │  Mimir    │            ││
│  │  └───────────┘  └───────────┘  └───────────┘            ││
│  └──────────────────────────────────────────────────────────┘│
└──────────────────────────────────────────────────────────────┘
```

### 3.3 핵심 컴포넌트

| 컴포넌트 | 역할 | 설명 |
|---------|------|------|
| **Prometheus Server** | 수집/저장 | Pull 방식으로 메트릭 수집, TSDB에 저장 |
| **Exporters** | 메트릭 노출 | 시스템/앱 메트릭을 Prometheus 형식으로 변환 |
| **Pushgateway** | 푸시 수집 | 배치 작업 등 단기 실행 작업용 |
| **Alertmanager** | 알림 관리 | 알림 그룹화, 라우팅, 중복 제거 |
| **Grafana** | 시각화 | 대시보드, 그래프, 알림 |

### 3.4 주요 Exporter 목록

| Exporter | 대상 |
|----------|------|
| Node Exporter | Linux 서버 (CPU, 메모리, 디스크) |
| Windows Exporter | Windows 서버 |
| MySQL Exporter | MySQL/MariaDB |
| PostgreSQL Exporter | PostgreSQL |
| Redis Exporter | Redis |
| Nginx Exporter | Nginx |
| Blackbox Exporter | HTTP/TCP/ICMP 프로브 |

### 3.5 특징

**장점:**
- 완전 무료 (오픈소스)
- 강력한 PromQL 쿼리 언어
- Kubernetes 네이티브 지원
- 풍부한 Exporter 생태계
- 활발한 커뮤니티

**단점:**
- 장기 저장 미지원 (기본 15일)
- 로그 수집 미지원 (Loki 필요)
- Pull 방식이라 방화벽 이슈 가능
- 운영/유지보수 부담

---

## 4. Splunk

### 4.1 개요

Splunk는 **머신 데이터 분석의 선구자**로, 로그 분석, SIEM, 옵저버빌리티를 모두 지원하는 엔터프라이즈 플랫폼입니다.

| 항목 | 내용 |
|------|------|
| **모델** | SaaS (Splunk Cloud) + On-Premise |
| **핵심 기능** | 로그 분석, SIEM, 옵저버빌리티 |
| **쿼리 언어** | SPL (Search Processing Language) |
| **데이터 처리** | Schema-on-Read (스키마 사전 정의 불필요) |

### 4.2 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                         데이터 소스                              │
│                                                                 │
│  ┌─────────────────┐           ┌─────────────────┐             │
│  │    Universal    │           │      Heavy      │             │
│  │    Forwarder    │           │    Forwarder    │             │
│  │                 │           │                 │             │
│  │ • 경량 (50MB)   │           │ • 파싱/필터링    │             │
│  │ • 원본 전송     │           │ • 데이터 변환    │             │
│  │ • CPU 최소화   │           │ • 라우팅        │             │
│  └────────┬────────┘           └────────┬────────┘             │
│           │                             │                       │
└───────────┼─────────────────────────────┼───────────────────────┘
            │                             │
            └──────────────┬──────────────┘
                           │ TCP/SSL
                           ▼
┌─────────────────────────────────────────────────────────────────┐
│                       Splunk Platform                            │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                   Indexer Cluster                          │ │
│  │                                                           │ │
│  │  ┌───────────┐  ┌───────────┐  ┌───────────┐             │ │
│  │  │ Indexer 1 │  │ Indexer 2 │  │ Indexer 3 │             │ │
│  │  │           │  │           │  │           │             │ │
│  │  │ • 파싱    │  │ • 인덱싱   │  │ • 복제    │             │ │
│  │  │ • 저장    │  │ • 검색    │  │ • 검색    │             │ │
│  │  └───────────┘  └───────────┘  └───────────┘             │ │
│  │                                                           │ │
│  │  기능:                                                    │ │
│  │  • 데이터 파싱 → 이벤트 추출                               │ │
│  │  • 타임스탬프 인식                                         │ │
│  │  • 인덱스 생성 (검색 가능하게)                              │ │
│  │  • 데이터 복제 (고가용성)                                   │ │
│  └───────────────────────────────────────────────────────────┘ │
│                              │                                  │
│                              ▼                                  │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                    Search Head Cluster                     │ │
│  │                                                           │ │
│  │  ┌───────────────┐  ┌───────────────┐                    │ │
│  │  │  Search Head  │  │  Search Head  │                    │ │
│  │  │      1        │  │      2        │                    │ │
│  │  └───────────────┘  └───────────────┘                    │ │
│  │                                                           │ │
│  │  기능:                                                    │ │
│  │  • SPL 쿼리 실행                                          │ │
│  │  • 대시보드 / 리포트                                       │ │
│  │  • 알림 설정                                              │ │
│  │  • 사용자 인터페이스                                       │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                 Cluster Manager (Master)                   │ │
│  │                                                           │ │
│  │  • 인덱서 클러스터 관리                                     │ │
│  │  • 복제 팩터 조정                                          │ │
│  │  • 검색 팩터 관리                                          │ │
│  └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

### 4.3 데이터 흐름

```
┌────────────┐    ┌────────────┐    ┌────────────┐    ┌────────────┐
│   Input    │───►│   Parsing  │───►│  Indexing  │───►│  Searching │
│            │    │            │    │            │    │            │
│ • 파일     │    │ • 라인분리  │    │ • 세그먼트 │    │ • SPL     │
│ • Syslog   │    │ • 타임스탬프│    │ • 압축    │    │ • 대시보드 │
│ • API      │    │ • 메타데이터│    │ • Bucket  │    │ • 알림    │
└────────────┘    └────────────┘    └────────────┘    └────────────┘
```

### 4.4 특징

**장점:**
- Schema-on-Read (유연한 데이터 구조)
- 강력한 SPL 쿼리 언어
- 엔터프라이즈급 확장성
- SIEM 기능 통합
- On-Premise 지원 (보안 요구사항 충족)

**단점:**
- 높은 라이선스 비용
- 데이터 용량 기반 과금
- 복잡한 설치/운영
- 학습 곡선

---

## 5. Elastic Stack (ELK)

### 5.1 개요

Elastic Stack(구 ELK Stack)은 **Elasticsearch, Logstash, Kibana, Beats**로 구성된 오픈소스 로그 분석 플랫폼입니다.

| 컴포넌트 | 역할 | 설명 |
|---------|------|------|
| **Elasticsearch** | 저장/검색 | 분산 검색 엔진 (Lucene 기반) |
| **Logstash** | 수집/변환 | 데이터 파이프라인 (ETL) |
| **Kibana** | 시각화 | 대시보드, 탐색, 알림 |
| **Beats** | 경량 수집 | 다양한 데이터 수집 에이전트 |

### 5.2 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                         데이터 소스                              │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                      Beats Family                        │   │
│  │                                                         │   │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐   │   │
│  │  │Filebeat  │ │Metricbeat│ │Packetbeat│ │Auditbeat │   │   │
│  │  │          │ │          │ │          │ │          │   │   │
│  │  │• 로그파일│ │• 시스템  │ │• 네트워크│ │• 감사로그│   │   │
│  │  │• 컨테이너│ │• Docker  │ │• 패킷분석│ │• 보안   │   │   │
│  │  └────┬─────┘ └────┬─────┘ └────┬─────┘ └────┬─────┘   │   │
│  │       │            │            │            │          │   │
│  └───────┼────────────┼────────────┼────────────┼──────────┘   │
│          │            │            │            │              │
└──────────┼────────────┼────────────┼────────────┼──────────────┘
           │            │            │            │
           └────────────┴─────┬──────┴────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                       Logstash                             │ │
│  │                                                           │ │
│  │  ┌──────────┐    ┌──────────────┐    ┌──────────┐        │ │
│  │  │  Input   │───►│    Filter    │───►│  Output  │        │ │
│  │  │          │    │              │    │          │        │ │
│  │  │ • Beats  │    │ • grok       │    │ • ES     │        │ │
│  │  │ • Kafka  │    │ • mutate     │    │ • S3     │        │ │
│  │  │ • HTTP   │    │ • date       │    │ • Kafka  │        │ │
│  │  │ • File   │    │ • geoip      │    │          │        │ │
│  │  └──────────┘    └──────────────┘    └──────────┘        │ │
│  └───────────────────────────────────────────────────────────┘ │
│                              │                                  │
│                              ▼                                  │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                    Elasticsearch Cluster                   │ │
│  │                                                           │ │
│  │  ┌─────────────────────────────────────────────────────┐ │ │
│  │  │                   Master Nodes                       │ │ │
│  │  │  • 클러스터 상태 관리                                 │ │ │
│  │  │  • 인덱스 생성/삭제                                   │ │ │
│  │  └─────────────────────────────────────────────────────┘ │ │
│  │                                                           │ │
│  │  ┌─────────────────────────────────────────────────────┐ │ │
│  │  │                    Data Nodes                        │ │ │
│  │  │                                                     │ │ │
│  │  │  ┌─────────┐  ┌─────────┐  ┌─────────┐            │ │ │
│  │  │  │ Node 1  │  │ Node 2  │  │ Node 3  │            │ │ │
│  │  │  │         │  │         │  │         │            │ │ │
│  │  │  │ Shard 0 │  │ Shard 1 │  │ Shard 2 │            │ │ │
│  │  │  │ Replica1│  │ Replica2│  │ Replica0│            │ │ │
│  │  │  └─────────┘  └─────────┘  └─────────┘            │ │ │
│  │  └─────────────────────────────────────────────────────┘ │ │
│  └───────────────────────────────────────────────────────────┘ │
│                              │                                  │
│                              ▼                                  │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                        Kibana                              │ │
│  │                                                           │ │
│  │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐     │ │
│  │  │Discover  │ │Dashboard │ │  Lens    │ │ Alerting │     │ │
│  │  │          │ │          │ │          │ │          │     │ │
│  │  │• 로그탐색│ │• 시각화  │ │• 드래그  │ │• 조건알림│     │ │
│  │  │• 필터   │ │• 그래프  │ │  드롭    │ │• 액션   │     │ │
│  │  └──────────┘ └──────────┘ └──────────┘ └──────────┘     │ │
│  └───────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

### 5.3 실제 사용 사례

| 기업 | 규모 | 용도 |
|------|------|------|
| **Netflix** | 15+ 클러스터, 800 노드 | 보안 로그 분석 |
| **LinkedIn** | 100+ 클러스터, 6 데이터센터 | 성능/보안 모니터링 |
| **Uber** | 대규모 | 실시간 로그 분석 |

### 5.4 특징

**장점:**
- 강력한 전문 검색 (Full-text Search)
- 경량 Beats 에이전트
- 유연한 Logstash 파이프라인
- 풍부한 Kibana 시각화
- Elastic Cloud (SaaS) 또는 Self-Hosted 선택 가능

**단점:**
- 메모리 사용량 높음 (JVM 기반)
- 클러스터 운영 복잡성
- 라이선스 변경 (SSPL)
- 시계열 메트릭에는 비효율적

---

## 6. OpenTelemetry

### 6.1 개요

OpenTelemetry(OTel)는 **벤더 중립적인 옵저버빌리티 데이터 수집 표준**으로, CNCF 졸업 프로젝트입니다.

| 항목 | 내용 |
|------|------|
| **유형** | 오픈소스 표준/프레임워크 |
| **관리** | CNCF (Cloud Native Computing Foundation) |
| **데이터 타입** | Traces, Metrics, Logs |
| **프로토콜** | OTLP (OpenTelemetry Protocol) |

### 6.2 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                       애플리케이션 계층                          │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                  OpenTelemetry SDK                         │ │
│  │                                                           │ │
│  │  ┌─────────────────────────────────────────────────────┐ │ │
│  │  │              Instrumentation                         │ │ │
│  │  │                                                     │ │ │
│  │  │  • Auto-instrumentation (자동 계측)                  │ │ │
│  │  │    - Java Agent                                     │ │ │
│  │  │    - Python auto-instrumentation                    │ │ │
│  │  │    - Node.js auto-instrumentation                   │ │ │
│  │  │                                                     │ │ │
│  │  │  • Manual instrumentation (수동 계측)                │ │ │
│  │  │    - Tracer API                                     │ │ │
│  │  │    - Meter API                                      │ │ │
│  │  │    - Logger API                                     │ │ │
│  │  └─────────────────────────────────────────────────────┘ │ │
│  │                                                           │ │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐               │ │
│  │  │  Traces  │  │ Metrics  │  │   Logs   │               │ │
│  │  └────┬─────┘  └────┬─────┘  └────┬─────┘               │ │
│  └───────┼─────────────┼─────────────┼───────────────────────┘ │
│          │             │             │                         │
└──────────┼─────────────┼─────────────┼─────────────────────────┘
           │             │             │
           └─────────────┼─────────────┘
                         │ OTLP (gRPC/HTTP)
                         ▼
┌─────────────────────────────────────────────────────────────────┐
│                  OpenTelemetry Collector                         │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐   │
│  │                      Receivers                           │   │
│  │                                                         │   │
│  │  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐        │   │
│  │  │  OTLP  │  │ Jaeger │  │Prometheus│ │ Zipkin │        │   │
│  │  │        │  │        │  │ (scrape)│  │        │        │   │
│  │  └────────┘  └────────┘  └────────┘  └────────┘        │   │
│  └─────────────────────────┬───────────────────────────────┘   │
│                            │                                    │
│  ┌─────────────────────────▼───────────────────────────────┐   │
│  │                     Processors                           │   │
│  │                                                         │   │
│  │  ┌────────────┐  ┌────────────┐  ┌────────────┐        │   │
│  │  │   Batch    │  │  Filter    │  │ Attributes │        │   │
│  │  │  Processor │  │ Processor  │  │ Processor  │        │   │
│  │  │            │  │            │  │            │        │   │
│  │  │ • 배치처리  │  │ • 필터링   │  │ • 속성추가 │        │   │
│  │  │ • 효율향상 │  │ • 샘플링   │  │ • 속성수정 │        │   │
│  │  └────────────┘  └────────────┘  └────────────┘        │   │
│  │                                                         │   │
│  │  ┌────────────┐  ┌────────────┐                        │   │
│  │  │  Memory    │  │  Resource  │                        │   │
│  │  │  Limiter   │  │ Processor  │                        │   │
│  │  └────────────┘  └────────────┘                        │   │
│  └─────────────────────────┬───────────────────────────────┘   │
│                            │                                    │
│  ┌─────────────────────────▼───────────────────────────────┐   │
│  │                      Exporters                           │   │
│  │                                                         │   │
│  │  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐        │   │
│  │  │  OTLP  │  │Prometheus│ │ Jaeger │  │Datadog │        │   │
│  │  │        │  │ Remote  │  │        │  │        │        │   │
│  │  └───┬────┘  └───┬────┘  └───┬────┘  └───┬────┘        │   │
│  └──────┼───────────┼───────────┼───────────┼──────────────┘   │
└─────────┼───────────┼───────────┼───────────┼──────────────────┘
          │           │           │           │
          ▼           ▼           ▼           ▼
    ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐
    │  Tempo   │ │Prometheus│ │  Jaeger  │ │ Datadog  │
    │ (Traces) │ │(Metrics) │ │ (Traces) │ │  Cloud   │
    └──────────┘ └──────────┘ └──────────┘ └──────────┘
```

### 6.3 배포 패턴

#### Agent 모드
```
┌────────────────────────────────────────┐
│              Host/Pod                   │
│  ┌──────────┐    ┌──────────────────┐  │
│  │   App    │───►│ OTel Collector   │──┼──► Backend
│  └──────────┘    │ (Sidecar/Agent)  │  │
│                  └──────────────────┘  │
└────────────────────────────────────────┘
```

#### Gateway 모드
```
┌──────────┐  ┌──────────┐  ┌──────────┐
│   App 1  │  │   App 2  │  │   App 3  │
└────┬─────┘  └────┬─────┘  └────┬─────┘
     │             │             │
     └─────────────┼─────────────┘
                   │ OTLP
                   ▼
          ┌────────────────┐
          │ OTel Collector │
          │   (Gateway)    │
          └───────┬────────┘
                  │
         ┌────────┼────────┐
         ▼        ▼        ▼
    ┌────────┐ ┌────────┐ ┌────────┐
    │Backend1│ │Backend2│ │Backend3│
    └────────┘ └────────┘ └────────┘
```

### 6.4 특징

**장점:**
- 벤더 중립 (Lock-in 방지)
- 표준화된 API/SDK
- 유연한 파이프라인 구성
- 모든 주요 백엔드 지원
- 활발한 커뮤니티

**단점:**
- 저장소/시각화 미포함 (별도 필요)
- 설정 복잡성
- 아직 발전 중 (Logs는 최근 안정화)

---

## 7. 아키텍처 비교 요약

### 7.1 배포 모델 비교

| 서비스 | 배포 모델 | Agent 설치 | 데이터 저장 위치 |
|--------|----------|-----------|-----------------|
| **Datadog** | SaaS Only | 필수 | Datadog Cloud |
| **메가존 Hyper** | MSP 서비스 | 불필요 | AWS (CloudWatch) |
| **New Relic** | SaaS Only | 필수 | New Relic Cloud |
| **Prometheus** | Self-Hosted | Exporter | 로컬 서버 |
| **Splunk** | SaaS + On-Prem | Forwarder | 선택 가능 |
| **ELK Stack** | SaaS + On-Prem | Beats | 선택 가능 |
| **OpenTelemetry** | 프레임워크 | SDK/Collector | 백엔드 의존 |

### 7.2 데이터 수집 방식 비교

| 서비스 | 수집 방식 | 주기 | 프로토콜 |
|--------|----------|------|----------|
| **Datadog** | Push (Agent) | 15초 | HTTPS |
| **메가존 Hyper** | Pull (API) | CloudWatch 의존 | AWS API |
| **New Relic** | Push (Agent) | 1분 | HTTPS |
| **Prometheus** | Pull (Scrape) | 15초 (설정 가능) | HTTP |
| **Splunk** | Push (Forwarder) | 실시간 | TCP/SSL |
| **ELK Stack** | Push (Beats) | 실시간 | HTTP/TCP |
| **OpenTelemetry** | Push (SDK) | 설정 가능 | OTLP (gRPC/HTTP) |

### 7.3 기능 비교 매트릭스

| 기능 | Datadog | 메가존 | New Relic | Prometheus | Splunk | ELK | OTel |
|------|---------|--------|-----------|------------|--------|-----|------|
| **메트릭** | ✅ | ✅ | ✅ | ✅ | ✅ | ⚠️ | ✅ |
| **로그** | ✅ | ⚠️ | ✅ | ❌ | ✅ | ✅ | ✅ |
| **트레이스** | ✅ | ❌ | ✅ | ❌ | ✅ | ✅ | ✅ |
| **APM** | ✅ | ❌ | ✅ | ❌ | ⚠️ | ⚠️ | ⚠️ |
| **알림** | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ❌ |
| **대시보드** | ✅ | ✅ | ✅ | Grafana | ✅ | ✅ | ❌ |
| **AI/ML** | ✅ | ❌ | ✅ | ❌ | ✅ | ⚠️ | ❌ |
| **On-Premise** | ❌ | ❌ | ❌ | ✅ | ✅ | ✅ | ✅ |

✅: 지원 / ⚠️: 부분 지원 또는 추가 구성 필요 / ❌: 미지원

### 7.4 비용 비교

| 서비스 | 과금 방식 | 대략적 비용 |
|--------|----------|------------|
| **Datadog** | 호스트 + 데이터 용량 | $15-23/호스트/월 + 용량 |
| **메가존 Hyper** | MSP 계약 | 협의 |
| **New Relic** | 사용자 + 데이터 | $0.30/GB (100GB 무료) |
| **Prometheus** | 무료 (인프라 비용) | 서버 비용만 |
| **Splunk** | 데이터 용량 | $150+/GB/일 |
| **ELK Stack** | 무료 또는 구독 | Elastic Cloud: $95+/월 |
| **OpenTelemetry** | 무료 (백엔드 비용) | 백엔드 의존 |

---

## 8. LLM 모니터링 적용 권장사항

### 8.1 시나리오별 추천

| 시나리오 | 추천 아키텍처 | 이유 |
|---------|-------------|------|
| **빠른 MVP 구축** | New Relic / Datadog | 즉시 사용 가능, AI 모니터링 지원 |
| **비용 최소화** | Prometheus + Grafana | 무료 오픈소스 |
| **로그 중심 분석** | ELK Stack | 강력한 전문 검색 |
| **벤더 종속 회피** | OpenTelemetry + 오픈소스 백엔드 | 표준화된 수집 |
| **엔터프라이즈/보안** | Splunk (On-Prem) | 데이터 내부 보관 |
| **AWS 환경 최적화** | 메가존 Hyper Solutions | AWS 전문 지원 |

### 8.2 LLM 모니터링 핵심 메트릭

| 카테고리 | 메트릭 | 수집 방법 |
|---------|--------|----------|
| **비용** | Token 사용량 (Input/Output) | API 응답 파싱 |
| **성능** | 응답 지연시간 (Latency) | 타이밍 측정 |
| **품질** | 에러율, 타임아웃 | 상태 코드 분석 |
| **사용량** | 요청 수, 사용자별 통계 | 카운터/히스토그램 |

### 8.3 권장 아키텍처 (LLM 모니터링)

```
┌─────────────────────────────────────────────────────────────────┐
│                      LLM 애플리케이션                            │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                    LLM Client SDK                          │ │
│  │                                                           │ │
│  │  ┌─────────────────────────────────────────────────────┐ │ │
│  │  │              Monitoring Middleware                   │ │ │
│  │  │                                                     │ │ │
│  │  │  • Request/Response 인터셉트                         │ │ │
│  │  │  • Token 카운팅                                     │ │ │
│  │  │  • Latency 측정                                     │ │ │
│  │  │  • Error 추적                                       │ │ │
│  │  └─────────────────────────────────────────────────────┘ │ │
│  └───────────────────────────────────────────────────────────┘ │
│                              │                                  │
└──────────────────────────────┼──────────────────────────────────┘
                               │
              ┌────────────────┼────────────────┐
              │                │                │
              ▼                ▼                ▼
       ┌───────────┐    ┌───────────┐    ┌───────────┐
       │  Metrics  │    │   Logs    │    │  Traces   │
       │           │    │           │    │           │
       │ • Token   │    │ • Request │    │ • 요청흐름 │
       │ • Latency │    │ • Response│    │ • 스팬    │
       │ • Errors  │    │ • Errors  │    │           │
       └─────┬─────┘    └─────┬─────┘    └─────┬─────┘
             │                │                │
             └────────────────┼────────────────┘
                              │
                              ▼
                    ┌───────────────────┐
                    │  OTel Collector   │  ← 벤더 중립 수집
                    │  또는 자체 수집기  │
                    └─────────┬─────────┘
                              │
              ┌───────────────┼───────────────┐
              │               │               │
              ▼               ▼               ▼
       ┌───────────┐   ┌───────────┐   ┌───────────┐
       │Prometheus │   │ Loki/ES   │   │  Jaeger   │
       │ + Grafana │   │           │   │  /Tempo   │
       └───────────┘   └───────────┘   └───────────┘
              │               │               │
              └───────────────┼───────────────┘
                              │
                              ▼
                    ┌───────────────────┐
                    │     Grafana       │
                    │   통합 대시보드    │
                    └───────────────────┘
```

---

## 참고 자료

### 공식 문서
- [Datadog Documentation](https://docs.datadoghq.com/)
- [New Relic Documentation](https://docs.newrelic.com/)
- [Prometheus Documentation](https://prometheus.io/docs/)
- [Grafana Documentation](https://grafana.com/docs/)
- [Splunk Documentation](https://docs.splunk.com/)
- [Elastic Stack Documentation](https://www.elastic.co/docs/)
- [OpenTelemetry Documentation](https://opentelemetry.io/docs/)

### 메가존클라우드
- [메가존클라우드 공식 사이트](https://www.megazone.com/)
- [메가존클라우드 - 나무위키](https://namu.wiki/w/메가존클라우드)

### 아키텍처 심화
- [Prometheus Architecture - DevOpsCube](https://devopscube.com/prometheus-architecture/)
- [Splunk Architecture - Cloudian](https://cloudian.com/guides/splunk-big-data/splunk-architecture-data-flow-components-and-topologies/)
- [ELK Stack Guide - Logz.io](https://logz.io/learn/complete-guide-elk-stack/)
- [OpenTelemetry Collector Architecture](https://opentelemetry.io/docs/collector/architecture/)

### 비교 분석
- [What is New Relic - Hostinger](https://www.hostinger.com/tutorials/what-is-new-relic)
- [ELK Stack - AWS](https://aws.amazon.com/what-is/elk-stack/)
- [Grafana + Prometheus Getting Started](https://grafana.com/docs/grafana/latest/getting-started/get-started-grafana-prometheus/)
